<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    {% if data.brand.name %}
      "name": "{{ data.brand.name | escape }}",
    {% else %}
      "name": "{{ shop.name | escape }}",
    {% endif %}
    "description": "{{ shop.description | escape }}",
    "url": "{{ shop.url }}",
    {% if data.brand.logo %}
      "logo": "{{ data.brand.logo }}",
    {% elsif data.logo %}
      "logo": "{{ data.logo }}",
    {% else %}
      "logo": "{{ shop.logo | default: shop.url | append: '/logo.png' }}",
    {% endif %}
    "sameAs": [
      "{% if data.socialLinks.facebook %}{{ data.socialLinks.facebook | escape }}{% endif %}",
      "{% if data.socialLinks.twitter %}{{ data.socialLinks.twitter | escape }}{% endif %}",
      "{% if data.socialLinks.instagram %}{{ data.socialLinks.instagram | escape }}{% endif %}",
      "{% if data.socialLinks.youtube %}{{ data.socialLinks.youtube | escape }}{% endif %}",
      "{% if data.socialLinks.pinterest %}{{ data.socialLinks.pinterest | escape }}{% endif %}",
      "{% if data.socialLinks.linkedin %}{{ data.socialLinks.linkedin | escape }}{% endif %}",
      "{% if data.socialLinks.snapchat %}{{ data.socialLinks.snapchat | escape }}{% endif %}",
      "{% if data.socialLinks.tiktok %}{{ data.socialLinks.tiktok | escape }}{% endif %}"
    ],
    "contactPoint": {
      "@type": "ContactPoint",
      "telephone": "{{ shop.phone | escape }}",
      "contactType": "Customer Service"
    },
    {% if data.showContact %}
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "{{ shop.address.address1 | escape }}{% if shop.address.address2 %}, {{ shop.address.address2 | escape }}{% endif %}",
      "addressLocality": "{{ shop.address.city | escape }}",
      "addressRegion": "{{ shop.address.province | escape }}",
      "postalCode": "{{ shop.address.zip | escape }}",
      "addressCountry": "{{ shop.address.country | escape }}"
    },
    {% endif %}
    "potentialAction": {
      "@type": "SearchAction",
      "target": "{{ shop.url }}/search?q={search_term_string}",
      "query-input": "required name=search_term_string"
    },
    "hasOfferCatalog": {
      "@type": "OfferCatalog",
      "name": "Featured Products",
      "itemListElement": [
        {% for product in collections['frontpage'].products %}
        {
          "@type": "Product",
          "name": "{{ product.title | escape }}",
          "image": [
            {% for image in product.images %}
              "{{ image.src | product_img_url: 'large' }}"{% if forloop.last == false %},{% endif %}
            {% endfor %}
          ],
          "sku": "{{ product.variants.first.sku | escape }}",
          "mpn": "{{ product.variants.first.barcode | escape }}",
          "brand": {
            "@type": "Brand",
            "name": "{{ product.vendor | escape }}"
          },
          "offers": {
            "@type": "Offer",
            "priceCurrency": "{{ shop.currency | escape }}",
            "price": "{{ product.price | money_without_currency | escape }}",
            "availability": "{% if product.available %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
            "url": "{{ shop.url }}/products/{{ product.handle }}"
          }
        }{% if forloop.last == false %},{% endif %}
        {% endfor %}
      ]
    }
  }
</script>
