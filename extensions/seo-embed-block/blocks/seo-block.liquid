{% assign shop_data = shop.metafields['bs-23-seo-app']['json-ld'].value %}

{% if request.page_type == 'product' %}
  {% assign data = product.metafields['bs-23-seo-app']['json-ld'].value %}
  {% if data != null and data.active %}
    {% render 'product', org_data: shop_data.organization, data: data.product %}
  {% endif %}
{% elsif request.page_type == 'collection' %}
  {% assign data = collection.metafields['bs-23-seo-app']['json-ld'].value %}
  {% if data != null and data.active %}
    {% render 'collection', org_data: shop_data.organization, data: data.collection %}
  {% endif %}
{% else %}
  {% if shop_data != null and shop_data.organization.status %}
    {% render 'organization', data: shop_data.organization %}
  {% endif %}
{% endif %}

{% assign homeSeoData = shop.metafields['seo-app-bs23']['home-seo-value'].value %}


{% if request.page_type == 'index' %}
  <title>
  {%- if homeSeoData.seo_title %}
    {{ homeSeoData.seo_title }}
  {%- else %}
    {{ page_title -}}
    {%- if current_tags %} &ndash; tagged "{{ current_tags | join: ', ' }}"{% endif -%}
    {%- if current_page != 1 %} &ndash; Page {{ current_page }}{% endif -%}
    {%- unless page_title contains shop.name %} &ndash; {{ shop.name }}{% endunless -%}
  {%- endif %}
  </title>

  {%- if homeSeoData.seo_description %}
    <meta name="description" content="{{ homeSeoData.seo_description | escape }}" />
  {%- else %}
     {% if page_description %}
     <meta name="description" content="{{ page_description | escape }}" />
     {% endif %}
  {%- endif %}
{% endif %}

{% schema %}
{
  "name": "SEO app",
  "target": "head"
}
{% endschema %}
